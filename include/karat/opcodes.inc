#define MAX_OPCODES 64
enum {
    HALT_CODE = 0x00,
    RET_CODE = 0x01,
    DUP_CODE = 0x02,
    ADDS_CODE = 0x03,
    ADDU_CODE = 0x04,
    SUBS_CODE = 0x05,
    SUBU_CODE = 0x06,
    MULS_CODE = 0x07,
    MULU_CODE = 0x08,
    DIVS_CODE = 0x09,
    DIVU_CODE = 0x0A,
    XORR_CODE = 0x0B,
    LOADR_CODE = 0x0C,
    MODR_CODE = 0x0D,
    PUSHR_CODE = 0x0E,
    POPR_CODE = 0x0F,
    JMPR_CODE = 0x10,
    LARG_CODE = 0x11,
    PUSHK_CODE = 0x12,
    ADDIS_CODE = 0x13,
    ADDIU_CODE = 0x14,
    SUBIS_CODE = 0x15,
    SUBIU_CODE = 0x16,
    LOADK_CODE = 0x17,
    PUTB_CODE = 0x18,
    PUTW_CODE = 0x19,
    PUTL_CODE = 0x1A,
    GETB_CODE = 0x1B,
    GETW_CODE = 0x1C,
    GETL_CODE = 0x1D,
    PUTR_CODE = 0x1E,
    PUTV_CODE = 0x1F,
    BEQ_CODE = 0x20,
    BNE_CODE = 0x21,
    BGT_CODE = 0x22,
    BLT_CODE = 0x23,
    JMP_CODE = 0x24,
    CALL_CODE = 0x25,
};

static const struct op_def op_defs[MAX_OPCODES] = {
    { L"halt", HALT_CODE, NO_MODE }, 
    { L"ret", RET_CODE, NO_MODE }, 
    { L"dup", DUP_CODE, NO_MODE }, 
    { L"adds", ADDS_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"addu", ADDU_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"subs", SUBS_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"subu", SUBU_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"muls", MULS_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"mulu", MULU_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"divs", DIVS_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"divu", DIVU_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"xorr", XORR_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"loadr", LOADR_CODE, rmode(1, 1, 0, 0, 0) }, 
    { L"modr", MODR_CODE, rmode(1, 1, 1, 0, 0) }, 
    { L"pushr", PUSHR_CODE, rmode(1, 0, 0, 0, 0) }, 
    { L"popr", POPR_CODE, rmode(1, 0, 0, 0, 0) }, 
    { L"jmpr", JMPR_CODE, imode(1, 0, 0) }, 
    { L"larg", LARG_CODE, imode(1, 0, 1) }, 
    { L"pushk", PUSHK_CODE, imode(0, 0, 1) }, 
    { L"addis", ADDIS_CODE, imode(1, 1, 1) }, 
    { L"addiu", ADDIU_CODE, imode(1, 1, 1) }, 
    { L"subis", SUBIS_CODE, imode(1, 1, 1) }, 
    { L"subiu", SUBIU_CODE, imode(1, 1, 1) }, 
    { L"loadk", LOADK_CODE, imode(1, 0, 1) }, 
    { L"putb", PUTB_CODE, imode(1, 1, 1) }, 
    { L"putw", PUTW_CODE, imode(1, 1, 1) }, 
    { L"putl", PUTL_CODE, imode(1, 1, 1) }, 
    { L"getb", GETB_CODE, imode(1, 1, 1) }, 
    { L"getw", GETW_CODE, imode(1, 1, 1) }, 
    { L"getl", GETL_CODE, imode(1, 1, 1) }, 
    { L"putr", PUTR_CODE, imode(1, 0, 0) }, 
    { L"putv", PUTV_CODE, imode(0, 0, 1) }, 
    { L"beq", BEQ_CODE, imode(1, 1, 1) }, 
    { L"bne", BNE_CODE, imode(1, 1, 1) }, 
    { L"bgt", BGT_CODE, imode(1, 1, 1) }, 
    { L"blt", BLT_CODE, imode(1, 1, 1) }, 
    { L"jmp", JMP_CODE, bmode(1) }, 
    { L"call", CALL_CODE, bmode(1) }, 
    { NULL, 0, NO_MODE }, 
};
